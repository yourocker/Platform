@model Core.Entities.CRM.Contact
@{
    ViewData["Title"] = Model.FullName;
}

<div class="container-fluid px-4">
    @* --- УНИФИЦИРОВАННЫЙ ХЕДЕР СТРАНИЦЫ (БЕЗ ДУБЛИРОВАНИЯ) --- *@
    <crm-page-header title="" icon="" subtitle="">
        <a asp-action="Index" crm-button variant="outline-secondary" icon="arrow-left">
            К списку
        </a>
        <a asp-action="Edit" asp-route-id="@Model.Id" crm-button variant="primary" icon="pencil-square">
            Изменить
        </a>
    </crm-page-header>

    <div class="row">
        <div class="col-lg-8">
            <div crm-card>
                <div class="card-body p-4">
                    @* Блок 1: ФИО *@
                    <div class="row g-4">
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-muted text-uppercase d-block">Фамилия</label>
                            <span class="fs-5">@Model.LastName</span>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-muted text-uppercase d-block">Имя</label>
                            <span class="fs-5">@Model.FirstName</span>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-muted text-uppercase d-block">Отчество</label>
                            <span class="fs-5">@(Model.MiddleName ?? "—")</span>
                        </div>
                    </div>

                    <hr class="my-4 text-muted opacity-25">

                    @* Блок 2: Контакты *@
                    <div class="row g-4">
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted text-uppercase d-block mb-2">Телефоны</label>
                            @if (Model.Phones != null && Model.Phones.Any())
                            {
                                @foreach (var phone in Model.Phones)
                                {
                                    <div class="d-flex align-items-center mb-2">
                                        <i class="bi bi-telephone me-2 text-primary"></i>
                                        <span>@phone.Number</span>
                                    </div>
                                }
                            }
                            else
                            {
                                <span class="text-muted">Нет данных</span>
                            }
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted text-uppercase d-block mb-2">Email адреса</label>
                            @if (Model.Emails != null && Model.Emails.Any())
                            {
                                @foreach (var email in Model.Emails)
                                {
                                    <div class="d-flex align-items-center mb-2">
                                        <i class="bi bi-envelope me-2 text-primary"></i>
                                        <a href="mailto:@email.Email" class="text-decoration-none text-dark text-primary-hover">@email.Email</a>
                                    </div>
                                }
                            }
                            else
                            {
                                <span class="text-muted">Нет данных</span>
                            }
                        </div>
                    </div>

                    @* Блок 3: Динамические поля (В том же контейнере через разделитель) *@
                    @* Мы не используем здесь заголовок, так как partial сам выводит метки полей *@
                    <div class="mt-4 pt-4 border-top">
                        <partial name="_DynamicFields" model="Model" />
                    </div>
                </div>
            </div>

            @* Удаление вынесено под основную карточку *@
            <div class="mt-3 d-flex justify-content-between align-items-center px-2">
                <div class="text-muted small">ID записи: @Model.Id</div>
                <a asp-action="Delete" asp-route-id="@Model.Id" class="text-danger small text-decoration-none opacity-75">
                    <i class="bi bi-trash me-1"></i> Удалить контакт
                </a>
            </div>
        </div>
    </div>
</div>